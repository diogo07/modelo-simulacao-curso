#ifndef __CURSO_PERIODO_H
#define __CURSO_PERIODO_H

#include <omnetpp.h>
#include "Aluno.h"

using namespace omnetpp;

class Periodo : public cSimpleModule {
    private:

//      CONF DA TURMA
        simsignal_t tamanhoFilaEspera;
        simsignal_t tamanhoTurma;

//      INFO DO PERIODO
        simsignal_t evadidosPorPeriodo[10];
        simsignal_t retidosPorPeriodo[10];

        simsignal_t evadidosPorSemestre[100];
        simsignal_t retidosPorSemestre[100];
        simsignal_t graduadosPorSemestre[100];

        simsignal_t evadidosSemestrePeriodo[100][10];
        simsignal_t retidosSemestrePeriodo[100][10];
        simsignal_t totalSemestrePeriodo[100][10];
        simsignal_t duracaoTransicaoPeriodo[100][10];


        simsignal_t totalEvadidos;
        simsignal_t quantidadeEvadidosGeral;
        simsignal_t quantidadeRetidosGeral;

        virtual bool compare(Aluno * aluno1, Aluno * aluno2);
        virtual void adicionarNaTurma(Aluno *aluno);
        virtual void avaliarAluno(Aluno *aluno);
        virtual void avaliarAlunoPorEvasaoEretencao(Aluno *aluno);
        virtual bool evadir(int semestre);
        virtual bool reter(int semestre);
        virtual void emitirDadosDoPeriodo();
        virtual void processarAluno(Aluno *aluno);
        virtual void registerSignalArray();
        virtual float randomValue();

    public:
        virtual ~Periodo() override;

    protected:

//      ATRIBUTOS DE CONFIGURA��O
        SimTime tempo;
        cQueue turma;
        cQueue filaEspera;
        int capacidadeTurma;
        int periodoAtual; // O �NDICE EQUIVALE AO PER�ODO, EX: INDICE 1 = 1� PERIODO
        int numeroPeriodos; // INDICA A QUANTIDADE DE PER�ODOS QUE O FORMATO DE CURSO POSSUI
        int portaSaida;
        int portaSaidaInicialRetencao;
        int analiseCurso = 2; // 0 - GERAL, 1 - BSI, 2 - BCC
        int analiseTipo = 0; // 0 - POR PERIODO, 1 - POR SEMESTRE, 2 - SEMESTRE E PERIODO

//      ESPEC�FICOS
        int contadorDeAlunosNaTurma;

//      GERAL
        int retidosGeral;
        int evadidosGeral;


//      TESTES
        bool evadido = false;

/**
 *
 * METRICAS DE EVAS�O E RETEN��O USADOS NO MODELO
 *
 */


//      UFRPE


//      POR PERIODO
        double probDeEvasaoPeriodo [3][10] = {
                {0.1738, 0.1337, 0.0878, 0.0543, 0.0374, 0.0428, 0.0364, 0.0174, 0.0149, 0.0093},
                {0.1735, 0.1263, 0.1053, 0.0758, 0.0638, 0.0396, 0.0457, 0.0251, 0.0364, 0.0093},
                {0.1741, 0.142, 0.0683, 0.0249, 0.0188, 0.0457, 0.0258, 0.0068, 0.0, 0.0}
        };


        double probDeRetencaoPeriodo [3][10] = {
                {0.4264, 0.5055, 0.5813, 0.5394, 0.5771, 0.5796, 0.603, 0.6261, 0.7079, 0.7674},
                {0.4472, 0.4965, 0.6427, 0.6091, 0.6117, 0.5842, 0.6, 0.6181, 0.6182, 0.7674},
                {0.4025, 0.5156, 0.5124, 0.444, 0.5526, 0.5753, 0.6065, 0.637, 0.7699, 0.0}
        };


//      POR SEMESTRE
        double probDeEvasaoSemestre [3][21] = {
                {0.14, 0.1559, 0.1225, 0.1601, 0.1064, 0.0993, 0.0744, 0.0359, 0.0804, 0.0472, 0.0376, 0.0542, 0.08, 0.022, 0.0794, 0.0816, 0.0882, 0.08, 0.125, 0.125, 0.0},
                {0.1326, 0.1604, 0.1403, 0.1597, 0.0954, 0.1009, 0.0765, 0.0276, 0.1163, 0.053, 0.0609, 0.0465, 0.0986, 0.0196, 0.0476, 0.0811, 0.0714, 0.0952, 0.0769, 0.125, 0.0},
                {0.1488, 0.1503, 0.1011, 0.1606, 0.119, 0.0973, 0.0719, 0.0458, 0.036, 0.041, 0.0102, 0.0625, 0.0556, 0.025, 0.1429, 0.0833, 0.1667, 0.0, 0.3333, 0.0, 0.0}
        };

        double probDeRetencaoSemestre [3][21] = {
                {0.2669, 0.2938, 0.1601, 0.0782, 0.0665, 0.0521, 0.0413, 0.0359, 0.0482, 0.0354, 0.0469, 0.0361, 0.024, 0.011, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0},
                {0.3196, 0.2682, 0.1672, 0.0694, 0.0539, 0.055, 0.0459, 0.0331, 0.0407, 0.0303, 0.0522, 0.0233, 0.0423, 0.0196, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.5},
                {0.2037, 0.3252, 0.1516, 0.0884, 0.081, 0.0486, 0.0359, 0.0392, 0.0576, 0.041, 0.0408, 0.05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0235}
        };


//        POR PERIODO E SEMESTRE
        double probDeEvasaoPeriodoSemestre[3][10][21] = {
                {{0.1261, 0.2081, 0.1937, 0.2667, 0.1928, 0.2683, 0.2273, 0.2, 0.2, 0.6667, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0508, 0.084, 0.2275, 0.1709, 0.2535, 0.2174, 0.24, 0.2857, 0.0, 0.0, 0.25, 0.3333, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0243, 0.0663, 0.0982, 0.175, 0.1636, 0.0857, 0.2105, 0.0714, 0.1111, 0.4286, 0.1667, 0.3333, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0741, 0.0341, 0.0355, 0.0581, 0.0727, 0.0455, 0.1562, 0.0476, 0.0769, 0.0, 0.1667, 0.0, 0.0, 0.5, 0.5, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0417, 0.01, 0.0194, 0.0119, 0.0, 0.087, 0.0968, 0.0476, 0.1818, 0.25, 0.25, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0263, 0.0282, 0.0625, 0.1042, 0.0312, 0.08, 0.1579, 0.0, 0.25, 0.5, 0.3333, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0238, 0.0, 0.0, 0.0192, 0.025, 0.0625, 0.12, 0.1176, 0.0, 0.3333, 0.1667, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0149, 0.0317, 0.0175, 0.0244, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.25, 0.3333, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.02, 0.0175, 0.0143, 0.0, 0.0426, 0.0, 0.0, 0.05, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0345, 0.037, 0.05, 0.0769, 0.0}},
                {{0.1218, 0.2125, 0.2406, 0.2192, 0.1795, 0.2857, 0.1667, 0.2, 0.3333, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.046, 0.102, 0.1977, 0.1346, 0.3667, 0.1, 0.25, 0.3333, 0.0, 0.0, 0.5, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.024, 0.119, 0.0926, 0.1351, 0.2, 0.0, 0.2727, 0.1111, 0.1667, 0.2, 0.25, 0.3333, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.037, 0.0408, 0.0506, 0.0976, 0.0769, 0.0417, 0.2632, 0.0714, 0.125, 0.0, 0.3333, 0.0, 0.0, 0.5, 0.5, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0417, 0.0192, 0.0426, 0.037, 0.0, 0.2353, 0.1429, 0.125, 0.3333, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0476, 0.0645, 0.1429, 0.1176, 0.0, 0.1, 0.2, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0238, 0.0, 0.0, 0.0, 0.0833, 0.1429, 0.2, 0.1667, 0.0, 0.3333, 0.3333, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0222, 0.0476, 0.037, 0.0769, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0303, 0.0323, 0.0333, 0.0, 0.2222, 0.0, 0.0, 0.25, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0345, 0.037, 0.05, 0.0769, 0.0}},
                {{0.1313, 0.2029, 0.1417, 0.3226, 0.2045, 0.25, 0.3, 0.2, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0569, 0.0609, 0.2593, 0.2, 0.1707, 0.3077, 0.2353, 0.25, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0246, 0.0122, 0.1034, 0.2093, 0.12, 0.2, 0.125, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0256, 0.0161, 0.0222, 0.069, 0.05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0588, 0.0, 0.125, 0.3333, 0.25, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0294, 0.0968, 0.0476, 0.0667, 0.1111, 0.0, 0.25, 0.3333, 0.5, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0303, 0.0, 0.0, 0.0667, 0.0909, 0.0, 0.3333, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}}
        };


        double probDeRetencaoPeriodoSemestre [3][10][21] = {
                {{0.2685, 0.1969, 0.0079, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.2966, 0.084, 0.0359, 0.0171, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.2996, 0.0843, 0.0089, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.3704, 0.142, 0.0993, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.125, 0.14, 0.0874, 0.0, 0.0185, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0256, 0.1169, 0.0658, 0.0141, 0.0208, 0.0, 0.0312, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.119, 0.0625, 0.0755, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1333, 0.0448, 0.0476, 0.0351, 0.0732, 0.069, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1429, 0.12, 0.0526, 0.0143, 0.0339, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2059, 0.0877, 0.0943, 0.0317, 0.0588, 0.0222, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}},
                {{0.3214, 0.1292, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.3142, 0.0612, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.344, 0.0476, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.3333, 0.1633, 0.0506, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0833, 0.1538, 0.0213, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0256, 0.125, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.119, 0.075, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1333, 0.0667, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1429, 0.0606, 0.0, 0.0333, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2059, 0.0877, 0.0943, 0.0317, 0.0588, 0.0222, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}},
                {{0.2053, 0.2754, 0.0167, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.2749, 0.113, 0.0741, 0.0308, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.2541, 0.122, 0.0172, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.1154, 0.1613, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.125, 0.1429, 0.0, 0.0244, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.1034, 0.1471, 0.025, 0.0294, 0.0, 0.0476, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0417, 0.1739, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1429, 0.0667, 0.1071, 0.125, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2353, 0.1154, 0.0, 0.0444, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}}
        };


        virtual void initialize() override;
        virtual void handleMessage(cMessage *msg) override;
        virtual void finish() override;
};


#endif
