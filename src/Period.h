#ifndef __COURSE_PERIOD_H
#define __COURSE_PERIOD_H

#include <omnetpp.h>

#include "Student.h"

using namespace omnetpp;

class Period : public cSimpleModule {
    private:

        simsignal_t dropoutsPerSemester[21];
        simsignal_t disapprovalsPerSemester[21];
        simsignal_t approvedsPerSemester[21];
        simsignal_t graduatesPerSemester[21];
//        simsignal_t totalPerSemester[21];
//        simsignal_t queueWaitSize[9000];
        simsignal_t queueWaitSize;
//        simsignal_t sizeClass[71];
        simsignal_t sizeClass;

        virtual bool compare(Student * student1, Student * student2);
        virtual void addToClass(Student *student);
        virtual void evaluate(Student *student);
        virtual bool dropout(int semestre);
        virtual bool disapprove(int semestre);
        virtual bool graduate(int semestre);
        virtual void emitStatisticsPeriod();
        virtual void processStudent(Student *student);
        virtual void registerSignalArray();
        virtual float randomValue();
        virtual void addToQueueWaiting(Student *student1);

    public:
        virtual ~Period() override;

    protected:

        //      ATRIBUTOS DE CONFIGURACAO
        SimTime timing;
        cQueue schoolClass;
        cQueue queueWaiting;
        int classCapacity;
        int currentPeriod; // O INDICE EQUIVALE AO PERIODO, EX: INDICE 1 = 1 PERIODO
        int numberOfPeriods; // INDICA A QUANTIDADE DE PERIODOS QUE O FORMATO DE CURSO POSSUI
        int outPort;
        int outPortDisapprovals;
        int course = 1; // 0 - BSI, 1 - BCC, 2 - VETERINARIA, 3 - AGRONOMIA
        int probsType = 1; // 0 - POR PERIODO, 1 - POR SEMESTRE, 2 - SEMESTRE E PERIODO

        //      ESPECIFICOS
        int studentsClassCount;


    /**
     *
     * CAPACIDADE DA TURMA POR PERÍODO
     *
     */


       int classCapabilities[10] = {70, 70, 70, 70, 40, 40, 40, 40, 40, 40};


    /**
     *
     * METRICAS DE EVASAO E REPROVACAO USADAS NO MODELO
     *
     */


       //      POR PERIODO
        double probsDropoutPeriod [2][10] = {
                {0.2384, 0.1028, 0.0759, 0.0415, 0.0437, 0.0428, 0.0087, 0.0114, 0.0, 0.0},
                {0.2573, 0.1135, 0.0662, 0.0272, 0.0267, 0.0396, 0.0138, 0.0142, 0.0, 0.0}
        };


        double probsDisapprovalPeriod [2][10] = {
                {0.6464, 0.6116, 0.5241, 0.4505, 0.4325, 0.5058, 0.476, 0.6866, 0.0},
                {0.6946, 0.5482, 0.4355, 0.4942, 0.4844, 0.4653, 0.3379, 0.3617, 0.2963},
        };


        //      POR DURACAO DE VINCULO
        double probsDropoutBondDuration [4][23] = {
                {0.1262, 0.1361, 0.1133, 0.1275, 0.0581, 0.1045, 0.0732, 0.033, 0.1018, 0.051, 0.0492, 0.0288, 0.0843, 0.0133, 0.037, 0.0698, 0.0541, 0.0, 0.0, 0.0, 0.0, 0.0},
                {0.1531, 0.1312, 0.0886, 0.1397, 0.0927, 0.0983, 0.0649, 0.0365, 0.0238, 0.0351, 0.0102, 0.05, 0.0417, 0.0179, 0.0714, 0.0435, 0.08, 0.0, 0.0, 0.0, 0.0, 0.0},
                {0.0589, 0.0675, 0.0395, 0.039, 0.0373, 0.0351, 0.0255, 0.022, 0.0138, 0.0237, 0.0085, 0.0249, 0.027, 0.0091, 0.0678, 0.0263, 0.037, 0.0588, 0.0833, 0.1667, 0.0, 0.0},
                {0.1684, 0.1278, 0.0832, 0.0878, 0.0697, 0.0679, 0.0394, 0.0464, 0.0251, 0.0202, 0.0345, 0.0094, 0.0556, 0.0444, 0.0385, 0.0625, 0.1667, 0.0, 0.0, 0.0, 0.0, 0.0},
        };

        double probsDisapprovalBondDuration [4][23] = {
                {0.4827, 0.5322, 0.4759, 0.4362, 0.3837, 0.4545, 0.4098, 0.4505, 0.4611, 0.4331, 0.5164, 0.625, 0.5542, 0.5067, 0.6667, 0.7674, 0.5676, 0.0, 0.0, 0.0, 0.0, 0.0},
                {0.45, 0.4438, 0.4502, 0.5066, 0.4488, 0.4682, 0.4416, 0.3577, 0.4048, 0.3158, 0.3163, 0.425, 0.4306, 0.3929, 0.2857, 0.2609, 0.44, 0.0, 0.0, 0.0, 0.0, 0.0},
                {0.2407, 0.2428, 0.2388, 0.232, 0.2614, 0.25, 0.287, 0.278, 0.2419, 0.2269, 0.1606, 0.3035, 0.2365, 0.2545, 0.339, 0.3421, 0.3704, 0.2941, 0.25, 0.3333, 0.0, 0.0},
                {0.3789, 0.3368, 0.3092, 0.3276, 0.2788, 0.2745, 0.2606, 0.2053, 0.1577, 0.1613, 0.2207, 0.2264, 0.2778, 0.2889, 0.4231, 0.375, 0.2778, 0.0, 0.0, 0.0, 0.0, 0.0},
        };

        double probsGraduationBondDuration [4][23] = {
                {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.024, 0.1146, 0.082, 0.1442, 0.0602, 0.16, 0.1296, 0.0465, 0.0901, 0.0, 0.0, 0.0, 0.0, 0.0},
                {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0073, 0.0556, 0.114, 0.1429, 0.0875, 0.1667, 0.125, 0.3095, 0.2609, 0.16, 0.0, 0.0, 0.0, 0.0, 0.0},
                {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1083, 0.0475, 0.4085, 0.2488, 0.223, 0.3727, 0.3051, 0.1579, 0.2222, 0.1176, 0.25, 0.0, 0.0, 1.0},
                {0.0, 0.0, 0.0036, 0.0107, 0.0168, 0.0245, 0.0091, 0.0364, 0.0609, 0.3871, 0.2414, 0.2736, 0.3611, 0.2667, 0.2308, 0.125, 0.1667, 0.0, 0.0, 0.0, 0.0, 0.0},
        };

        //      POR PERIODO E DURACAO DE VINCULO
        double probsDropoutPeriodBondDuration[2][10][22] = {
                {{0.1163, 0.2359, 0.2348, 0.2419, 0.1818, 0.1875, 0.25, 0.2, 0.3333, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0383, 0.0902, 0.1842, 0.0784, 0.3438, 0.12, 0.1667, 0.25, 0.0, 0.0, 0.3333, 0.0, 0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0095, 0.0851, 0.0204, 0.1786, 0.28, 0.05, 0.3636, 0.1, 0.2, 0.0, 0.6667, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0152, 0.0548, 0.0667, 0.0385, 0.0, 0.2667, 0.1818, 0.1429, 0.0, 0.0, 0.0, 0.0, 0.5, 0.3333, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0444, 0.0769, 0.1579, 0.0, 0.0, 0.0, 0.4, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0217, 0.0, 0.0, 0.0, 0.1333, 0.125, 0.1818, 0.1429, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0789, 0.0667, 0.125, 0.0, 0.0833, 0.0, 0.0, 0.0, 0.3333, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0833, 0.0, 0.0, 0.1429, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0225, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.25, 0.0, 0.0, 0.0, 0.0, 0.0}},
                {{0.1375, 0.2397, 0.1647, 0.2979, 0.1875, 0.2941, 0.4, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0402, 0.0933, 0.3125, 0.2, 0.1667, 0.2, 0.3333, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.018, 0.0189, 0.1143, 0.3462, 0.1053, 0.25, 0.2, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0123, 0.0455, 0.0, 0.1111, 0.0769, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0909, 0.0, 0.3333, 0.25, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0952, 0.0714, 0.0, 0.0, 0.3333, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.069, 0.0, 0.0, 0.1667, 0.1667, 0.0, 0.3333, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3333, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0714, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}},
        };


        double probsDisapprovalPeriodBondDuration [2][10][22] = {
                {{0.4827, 0.5897, 0.5391, 0.5323, 0.4848, 0.5, 0.625, 0.6, 0.6667, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.4785, 0.5188, 0.6447, 0.5882, 0.7188, 0.48, 0.6667, 0.75, 0.5, 1.0, 1.0, 0.6667, 1.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.3524, 0.3617, 0.4286, 0.7143, 0.72, 0.5, 0.9091, 0.4, 0.8, 0.75, 1.0, 0.3333, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.2121, 0.3425, 0.4222, 0.5769, 0.7059, 0.7333, 0.4545, 0.4286, 0.6667, 1.0, 1.0, 1.0, 1.0, 0.3333, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.1346, 0.434, 0.4, 0.5769, 0.5789, 0.4286, 0.625, 0.8333, 0.4, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.1522, 0.1622, 0.303, 0.4737, 0.8, 0.5, 0.5455, 0.2857, 0.4, 1.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2564, 0.4, 0.5263, 0.4, 0.5, 0.6429, 0.5833, 0.3, 0.2, 1.0, 0.6667, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2759, 0.2424, 0.32, 0.3913, 0.5, 0.4167, 0.6, 0.4545, 0.7143, 0.1667, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.4048, 0.55, 0.6512, 0.6571, 0.6111, 0.7931, 0.7857, 0.6067, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3333, 0.25, 0.0, 0.0, 0.5, 1.0, 0.625, 0.0, 0.0, 0.0, 0.0, 0.0}},
                {{0.45, 0.5822, 0.5529, 0.6809, 0.5312, 0.5882, 0.5, 0.2, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.3276, 0.6, 0.7083, 0.4857, 0.5, 0.6, 0.5, 0.3333, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.2703, 0.5283, 0.6571, 0.6538, 0.3684, 0.5, 0.6, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.2716, 0.3864, 0.4643, 0.5556, 0.4615, 0.25, 0.5, 0.6667, 0.5, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.2807, 0.4634, 0.5667, 0.4167, 0.4, 0.5455, 0.2857, 1.0, 0.75, 0.3333, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 1.0, 0.3023, 0.4865, 0.3636, 0.5385, 0.4286, 0.4286, 0.4444, 0.75, 1.0, 0.3333, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1667, 0.4545, 0.3103, 0.381, 0.3529, 0.6667, 0.4167, 0.5, 0.6667, 0.3333, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.12, 0.5625, 0.2667, 0.3, 0.2941, 0.3333, 0.2222, 0.6667, 0.6667, 0.625, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2609, 0.0833, 0.2571, 0.3333, 0.3902, 0.3824, 0.1875, 0.1333, 0.3571, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}},
        };

        double probsGraduationPeriodBondDuration [2][10][22] = {
                {{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0667, 0.0, 0.1429, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.04, 0.0, 0.0625, 0.0833, 0.0, 0.0909, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1429, 0.3571, 0.175, 0.2791, 0.0286, 0.1944, 0.1724, 0.0714, 0.1011, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.6667, 0.5, 0.75, 1.0, 0.5, 0.0, 0.125, 0.0, 0.0, 0.0, 0.0, 0.0}},
                {{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0303, 0.0, 0.0476, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0625, 0.0333, 0.05, 0.0, 0.0, 0.2222, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2609, 0.4583, 0.3714, 0.1944, 0.2927, 0.1471, 0.4062, 0.4, 0.2857, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}},
        };


        virtual void initialize() override;
        virtual void handleMessage(cMessage *msg) override;
        virtual void finish() override;
};


#endif
